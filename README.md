# りょう鯖 ローカル検証環境
本環境はりょう鯖の検証用となっており、実行環境をローカルで手軽に再現することを目的に作成されています。

実環境で使用されているGCPやファイルサーバにはアクセスできないため、代替手段を使用しています。

## 動作環境
- OS: Windows 11
- Docker Desktop 4.49.0 (構築時バージョン)

## 環境について
りょう鯖には主に3つの環境が存在している。本レポジトリは「ローカル開発環境」に位置付けられる。
| 環境名 | 用途 |
| --- | --- |
| ローカル開発環境 | プラグインのバージョン検証など手軽に検証を行える環境/ローカルDocker |
| 開発環境 | リリース前の動作確認を行う環境/k8s上で稼働 |
| 本番環境 | サービス提供を行う環境/k8s上で稼働 |

## 環境構築手順
1. `./script/setup.ps1`を実行

2. Giteaのセットアップ
    1. http://localhost:30080 にアクセス
    2. Giteaの初期設定画面に遷移するので、「SSHサーバーのポート」を"30022"に変更し、「Giteaをインストール」を押下
    3. Giteaのユーザ登録画面に遷移するので、任意の情報でユーザを作成

3. GiteaにLocal-Dev-Envレポジトリをコピーする
    1. Giteaでレポジトリを作成
    2. レポジトリのURLを取得
    3. 本レポジトリのルートで以下のコマンドを実行
        ```
        git remote add gitea <Gitea レポジトリURL>
        git push --mirror gitea
        ```